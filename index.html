<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculateur de baies non protégées (CNB)</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f9f9f9; }
        #app { max-width: 800px; margin: 0 auto; padding: 20px; background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        h1 { color: #333; text-align: center; }
        .tab-nav { overflow: hidden; background-color: #f1f1f1; border-bottom: 1px solid #ccc; }
        .tab-nav button { background-color: inherit; float: left; border: none; outline: none; cursor: pointer; padding: 14px 16px; transition: 0.3s; font-size: 16px; }
        .tab-nav button:hover { background-color: #ddd; }
        .tab-nav button.active { background-color: #004d99; color: white; }
        .tab-content { display: none; padding: 20px; border: 1px solid #ccc; border-top: none; }
        .tab-content.active { display: block; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin: 10px 0; font-size: 16px; }
        input[type="number"], select { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { margin: 10px 0; padding: 10px 20px; background-color: #007BFF; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #0056b3; }
        .results { background-color: #f1f1f1; padding: 20px; border-radius: 8px; margin-top: 20px; }
        .info { font-style: italic; font-size: 14px; color: #666; margin-top: 5px; }
        .subsection { padding-left: 20px; margin-top: 20px; border-left: 3px solid #ccc; }
        .toggle-section { cursor: pointer; color: #0056b3; }
        .toggle-section:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div id="app">
        <h1>Calculateur de baies non protégées (CNB)</h1>
        <div class="tab-nav">
            <button class="tab-link active" onclick="openTab(event, 'cnb')">Méthode CNB (3.2.3.)</button>
            <button class="tab-link" onclick="openTab(event, 'method91014')">Méthode 9.10.14</button>
            <button class="tab-link" onclick="openTab(event, 'method91015')">Méthode 9.10.15</button>
        </div>

        <!-- Onglet Méthode CNB (3.2.3.) -->
        <div id="cnb" class="tab-content active">
            <p>Calcul basé sur la section 3.2.3 du CNB</p>
            <div class="form-group">
                <label for="usage_cnb">Usage du bâtiment</label>
                <select id="usage_cnb">
                    <option value="groupes_A_B3_C_D_F3">Usages des groupes A, B division 3, C, D et F division 3</option>
                    <option value="groupes_E_F1_F2">Usages des groupes E et F divisions 1 et 2</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="construction_type_cnb">Type de construction</label>
                <select id="construction_type_cnb">
                    <option value="incombustible">Incombustible</option>
                    <option value="combustible">Combustible</option>
                </select>
                <div class="info">Selon 3.2.3.7, le type de construction a un impact sur les exigences.</div>
            </div>
            
            <div class="form-group">
                <label for="revetement_type_cnb">Type de revêtement</label>
                <select id="revetement_type_cnb">
                    <option value="incombustible">Incombustible</option>
                    <option value="combustible">Combustible</option>
                </select>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="sprinklers_cnb"> Bâtiment entièrement protégé par gicleurs</label>
            </div>
            
            <div class="form-group">
                <label for="distance_cnb">Distance limitative (m)</label>
                <input type="number" id="distance_cnb" value="5" min="0" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="surface_cnb">Surface de la façade de rayonnement (m²)</label>
                <input type="number" id="surface_cnb" value="120" min="0">
            </div>
            
            <div class="form-group">
                <label for="length_cnb">Longueur de la façade (m)</label>
                <input type="number" id="length_cnb" value="20" min="0">
            </div>
            
            <div class="form-group">
                <label for="height_cnb">Hauteur de la façade (m)</label>
                <input type="number" id="height_cnb" value="6" min="0">
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="glass_brick_cnb"> Baies protégées par briques de verre/verre armé</label>
                <div class="info">Selon 3.2.3.12, permet de doubler la surface maximale autorisée.</div>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="response_cnb"> Plus de 10 min dans 10 % ou plus des cas</label>
                <div class="info">Si coché, la distance limitative est divisée par 2 (selon le paragraphe 3.2.3.1. 8))</div>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="fire_dampers_cnb"> Registres coupe-feu pour ouvertures techniques</label>
                <div class="info">Protection des ouvertures techniques dans la façade de rayonnement par registres coupe-feu</div>
            </div>
            
            <div class="toggle-section" onclick="toggleSection('adjacent_facades_cnb_section')">+ Expositions aux façades adjacentes (3.2.3.14)</div>
            <div id="adjacent_facades_cnb_section" class="subsection" style="display: none;">
                <div class="form-group">
                    <label><input type="checkbox" id="has_adjacent_facade_cnb"> Présence de façade adjacente</label>
                </div>
                <div class="form-group">
                    <label for="angle_facades_cnb">Angle entre les façades (degrés)</label>
                    <input type="number" id="angle_facades_cnb" value="90" min="0" max="180" step="1">
                    <div class="info">Angle formé par les façades. Selon 3.2.3.14, l'angle influence le calcul.</div>
                </div>
                <div class="form-group">
                    <label for="adjacent_facade_length_cnb">Longueur de la façade adjacente (m)</label>
                    <input type="number" id="adjacent_facade_length_cnb" value="10" min="0" step="0.1">
                </div>
            </div>
            
            <div class="toggle-section" onclick="toggleSection('adjacent_roof_cnb_section')">+ Expositions à des toits adjacents (3.2.3.15)</div>
            <div id="adjacent_roof_cnb_section" class="subsection" style="display: none;">
                <div class="form-group">
                    <label><input type="checkbox" id="has_adjacent_roof_cnb"> Présence d'un toit adjacent</label>
                </div>
                <div class="form-group">
                    <label for="distance_to_roof_cnb">Distance horizontale entre la façade et le toit (m)</label>
                    <input type="number" id="distance_to_roof_cnb" value="2" min="0" step="0.1">
                    <div class="info">Distance horizontale entre la façade de rayonnement et le toit adjacent.</div>
                </div>
                <div class="form-group">
                    <label for="height_diff_roof_cnb">Différence de hauteur entre ouvertures et toit (m)</label>
                    <input type="number" id="height_diff_roof_cnb" value="3" min="0" step="0.1">
                    <div class="info">Différence de hauteur entre les ouvertures de la façade et le toit adjacent.</div>
                </div>
            </div>
            
            <button onclick="calculateCNB()">Calculer</button>
            <div id="cnb-result" class="results"></div>
        </div>

        <!-- Onglet Méthode 9.10.14 -->
        <div id="method91014" class="tab-content">
            <p>Calcul basé sur la sous-section 9.10.14 du CNB (Tableau 9.10.14.4-A)</p>
            <div class="form-group">
                <label for="usage_91014">Usage du bâtiment</label>
                <select id="usage_91014">
                    <option value="habitation">Habitation, établissement d'affaires et établissement industriel à risques faibles</option>
                    <option value="commercial">Établissement commercial et établissement industriel à risques moyens</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="building_type_91014">Type de bâtiment</label>
                <select id="building_type_91014">
                    <option value="standard">Bâtiment standard</option>
                    <option value="garage">Garage ou bâtiment secondaire</option>
                </select>
                <div class="info">Les garages et bâtiments secondaires peuvent bénéficier d'exemptions selon 9.10.14.4(10-12) et 9.10.14.5(4-5).</div>
            </div>
            
            <div class="form-group">
                <label for="distance_91014">Distance limitative (m)</label>
                <input type="number" id="distance_91014" value="2.0" min="0" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="surface_91014">Surface de la façade de rayonnement (m²)</label>
                <input type="number" id="surface_91014" value="30" min="0">
            </div>
            
            <div class="form-group">
                <label for="exterior_finish_91014">Type de revêtement extérieur</label>
                <select id="exterior_finish_91014">
                    <option value="combustible">Combustible</option>
                    <option value="incombustible">Incombustible</option>
                </select>
                <div class="info">Le type de revêtement est important pour les distances limitatives inférieures à 1,2 m.</div>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="soffit_protection_91014"> Soffites protégés</label>
                <div class="info">Concerne les soffites faisant saillie à moins de 1,2 m de la limite de propriété (9.10.14.5).</div>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="response_91014"> Plus de 10 min dans 10 % ou plus des cas</label>
                <div class="info">Si coché, la distance limitative est divisée par 2 (selon le paragraphe 9.10.14.3. 1))</div>
            </div>
            
            <div class="toggle-section" onclick="toggleSection('adjacent_facades_91014_section')">+ Expositions aux façades adjacentes (9.10.14.14)</div>
            <div id="adjacent_facades_91014_section" class="subsection" style="display: none;">
                <div class="form-group">
                    <label><input type="checkbox" id="has_adjacent_facade_91014"> Présence de façade adjacente</label>
                </div>
                <div class="form-group">
                    <label for="angle_facades_91014">Angle entre les façades (degrés)</label>
                    <input type="number" id="angle_facades_91014" value="90" min="0" max="180" step="1">
                    <div class="info">Angle formé par les façades. Selon 9.10.14.14, influence le calcul.</div>
                </div>
                <div class="form-group">
                    <label for="adjacent_facade_length_91014">Longueur de la façade adjacente (m)</label>
                    <input type="number" id="adjacent_facade_length_91014" value="10" min="0" step="0.1">
                </div>
            </div>
            
            <button onclick="calculate91014()">Calculer</button>
            <div id="method91014-result" class="results"></div>
        </div>

        <!-- Onglet Méthode 9.10.15 -->
        <div id="method91015" class="tab-content">
            <p>Calcul basé sur la sous-section 9.10.15 du CNB (Tableau 9.10.15.4) - Pour habitations</p>
            <div class="info">Cette méthode s'applique uniquement aux bâtiments qui ne renferment que des logements et dont aucun des logements n'est situé au-dessus d'un autre logement.</div>
            
            <div class="form-group">
                <label for="housing_type_91015">Type d'habitation</label>
                <select id="housing_type_91015">
                    <option value="standard">Habitation standard</option>
                    <option value="accessoire">Maison comportant un logement accessoire</option>
                </select>
                <div class="info">Selon 9.10.15.1., les maisons comportant un logement accessoire suivent des règles spécifiques.</div>
            </div>
            
            <div class="form-group">
                <label for="distance_91015">Distance limitative (m)</label>
                <input type="number" id="distance_91015" value="2.0" min="0" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="surface_91015">Surface de la façade de rayonnement (m²)</label>
                <input type="number" id="surface_91015" value="50" min="0">
            </div>
            
            <div class="form-group">
                <label for="reveting_type_91015">Type de revêtement extérieur</label>
                <select id="reveting_type_91015">
                    <option value="combustible">Combustible</option>
                    <option value="incombustible">Incombustible</option>
                </select>
                <div class="info">Selon 9.10.15.5, le type de revêtement a un impact sur les exigences de construction.</div>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="response_91015"> Plus de 10 min dans 10 % ou plus des cas</label>
                <div class="info">Si coché, la distance limitative est divisée par 2 (selon le paragraphe 9.10.15.3. 1))</div>
            </div>
            
            <button onclick="calculate91015()">Calculer</button>
            <div id="method91015-result" class="results"></div>
        </div>
    </div>

    <script>
        // Fonction pour afficher/masquer les sections supplémentaires
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section.style.display === "none") {
                section.style.display = "block";
            } else {
                section.style.display = "none";
            }
        }
        
        // Tableau 3.2.3.1.-B - Usages des groupes A, B3, C, D et F3 - Sans gicleurs
        const tableauGroupesAB3CDF3 = {
            10: {
                "< 3:1": [0, 8, 10, 18, 29, 46, 91, 100],
                "3:1 à 10:1": [0, 8, 12, 21, 33, 50, 96, 100],
                "> 10:1": [0, 11, 18, 32, 48, 68, 100]
            },
            15: {
                "< 3:1": [0, 7, 9, 14, 22, 33, 63, 100],
                "3:1 à 10:1": [0, 8, 10, 17, 25, 37, 67, 100],
                "> 10:1": [0, 10, 15, 26, 39, 53, 87, 100]
            },
            20: {
                "< 3:1": [0, 7, 9, 12, 18, 26, 49, 81, 100],
                "3:1 à 10:1": [0, 8, 10, 15, 21, 30, 53, 85, 100],
                "> 10:1": [0, 9, 14, 23, 33, 45, 72, 100]
            },
            25: {
                "< 3:1": [0, 7, 8, 11, 16, 23, 41, 66, 98, 100],
                "3:1 à 10:1": [0, 8, 9, 13, 19, 26, 45, 70, 100],
                "> 10:1": [0, 9, 13, 21, 30, 39, 62, 90, 100]
            },
            30: {
                "< 3:1": [0, 7, 8, 11, 15, 20, 35, 56, 83, 100],
                "3:1 à 10:1": [0, 7, 9, 12, 17, 23, 39, 61, 88, 100],
                "> 10:1": [0, 8, 12, 19, 27, 36, 56, 79, 100]
            },
            40: {
                "< 3:1": [0, 7, 8, 10, 13, 17, 28, 44, 64, 89, 100],
                "3:1 à 10:1": [0, 7, 8, 11, 15, 20, 32, 48, 69, 93, 100],
                "> 10:1": [0, 8, 11, 17, 24, 31, 47, 66, 88, 100]
            },
            50: {
                "< 3:1": [0, 7, 8, 9, 12, 15, 24, 37, 53, 72, 96, 100],
                "3:1 à 10:1": [0, 7, 8, 10, 14, 18, 28, 41, 57, 77, 100],
                "> 10:1": [0, 8, 10, 15, 21, 28, 41, 57, 76, 97, 100]
            },
            60: {
                "< 3:1": [0, 7, 8, 9, 11, 14, 21, 32, 45, 62, 81, 100],
                "3:1 à 10:1": [0, 7, 8, 10, 13, 16, 25, 36, 49, 66, 85, 100],
                "> 10:1": [0, 8, 10, 14, 20, 25, 38, 51, 67, 85, 100]
            },
            80: {
                "< 3:1": [0, 7, 7, 8, 10, 12, 18, 26, 36, 48, 62, 79, 98, 100],
                "3:1 à 10:1": [0, 7, 8, 9, 11, 14, 21, 29, 40, 52, 67, 84, 100],
                "> 10:1": [0, 8, 9, 13, 17, 22, 32, 44, 56, 70, 86, 100]
            },
            100: {
                "< 3:1": [0, 7, 7, 8, 9, 11, 16, 22, 30, 40, 51, 65, 80, 97, 100],
                "3:1 à 10:1": [0, 7, 8, 9, 11, 13, 18, 25, 34, 44, 56, 69, 84, 100],
                "> 10:1": [0, 7, 9, 12, 16, 20, 29, 39, 49, 61, 74, 89, 100]
            },
            150: {
                "< 3:1": [0, 7, 7, 8, 9, 10, 13, 17, 22, 29, 37, 46, 56, 67, 79, 93, 100],
                "3:1 à 10:1": [0, 7, 7, 8, 10, 11, 15, 20, 26, 33, 41, 50, 60, 71, 84, 97, 100],
                "> 10:1": [0, 7, 8, 11, 13, 17, 24, 31, 39, 48, 57, 68, 79, 91, 100]
            },
            250: {
                "< 3:1": [0, 7, 7, 7, 8, 9, 10, 13, 16, 20, 25, 30, 36, 43, 51, 59, 68, 87, 100],
                "3:1 à 10:1": [0, 7, 7, 8, 9, 10, 12, 15, 19, 24, 28, 34, 40, 47, 55, 63, 72, 92, 100],
                "> 10:1": [0, 7, 8, 9, 11, 14, 19, 24, 30, 36, 43, 50, 57, 65, 73, 82, 92, 100]
            },
            350: {
                "< 3:1": [0, 7, 7, 7, 8, 8, 9, 11, 14, 16, 20, 24, 28, 33, 38, 44, 50, 64, 81, 99, 100],
                "3:1 à 10:1": [0, 7, 7, 8, 8, 9, 11, 13, 16, 19, 23, 27, 32, 37, 42, 48, 55, 69, 85, 100],
                "> 10:1": [0, 7, 8, 9, 10, 12, 16, 21, 25, 30, 36, 41, 47, 53, 59, 66, 73, 88, 100]
            },
            500: {
                "< 3:1": [0, 7, 7, 7, 7, 8, 9, 10, 12, 14, 16, 19, 22, 25, 29, 33, 37, 47, 59, 71, 100],
                "3:1 à 10:1": [0, 7, 7, 7, 8, 8, 10, 12, 14, 16, 19, 22, 25, 29, 33, 37, 41, 52, 63, 76, 100],
                "> 10:1": [0, 7, 7, 8, 9, 11, 14, 18, 22, 25, 30, 34, 38, 43, 48, 53, 58, 70, 82, 96, 100]
            },
            1000: {
                "< 3:1": [0, 7, 7, 7, 7, 7, 8, 9, 9, 10, 12, 13, 14, 16, 18, 20, 22, 27, 33, 39, 58, 82, 100],
                "3:1 à 10:1": [0, 7, 7, 7, 7, 8, 9, 10, 11, 12, 14, 15, 17, 19, 21, 23, 26, 31, 37, 43, 63, 86, 100],
                "> 10:1": [0, 7, 7, 8, 8, 9, 11, 13, 16, 19, 21, 24, 27, 30, 33, 36, 39, 46, 53, 60, 82, 100]
            },
            2000: {
                "< 3:1": [0, 7, 7, 7, 7, 7, 7, 8, 8, 9, 9, 10, 11, 12, 13, 14, 15, 17, 20, 23, 33, 44, 58, 74, 93, 100],
                "3:1 à 10:1": [0, 7, 7, 7, 7, 7, 8, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 20, 23, 27, 37, 49, 63, 79, 97, 100],
                "> 10:1": [0, 7, 7, 7, 8, 8, 9, 11, 12, 14, 16, 18, 19, 21, 23, 25, 27, 32, 36, 40, 53, 66, 82, 99, 100]
            }
        };
        
        // Tableau 3.2.3.1.-C - Usages des groupes E, F1 et F2 - Sans gicleurs
        const tableauGroupesEF1F2 = {
            10: {
                "< 3:1": [0, 4, 5, 9, 15, 23, 46, 77, 100],
                "3:1 à 10:1": [0, 4, 6, 10, 17, 25, 48, 79, 100],
                "> 10:1": [0, 5, 9, 16, 24, 34, 58, 91, 100]
            },
            15: {
                "< 3:1": [0, 4, 5, 7, 11, 16, 32, 53, 79, 100],
                "3:1 à 10:1": [0, 4, 5, 8, 13, 18, 34, 55, 82, 100],
                "> 10:1": [0, 5, 8, 13, 19, 26, 43, 66, 93, 100]
            },
            20: {
                "< 3:1": [0, 4, 4, 6, 9, 13, 25, 40, 61, 85, 100],
                "3:1 à 10:1": [0, 4, 5, 7, 11, 15, 27, 43, 63, 87, 100],
                "> 10:1": [0, 5, 7, 11, 17, 22, 36, 53, 74, 99, 100]
            },
            25: {
                "< 3:1": [0, 4, 4, 6, 8, 11, 20, 33, 49, 69, 92, 100],
                "3:1 à 10:1": [0, 4, 5, 7, 9, 13, 22, 35, 51, 71, 94, 100],
                "> 10:1": [0, 4, 6, 10, 15, 20, 31, 45, 62, 82, 100]
            },
            30: {
                "< 3:1": [0, 4, 4, 5, 7, 10, 18, 28, 42, 58, 77, 100],
                "3:1 à 10:1": [0, 4, 4, 6, 9, 12, 20, 30, 44, 60, 80, 100],
                "> 10:1": [0, 4, 6, 10, 14, 18, 28, 40, 54, 71, 91, 100]
            },
            40: {
                "< 3:1": [0, 4, 4, 5, 6, 8, 14, 22, 32, 44, 59, 76, 94, 100],
                "3:1 à 10:1": [0, 4, 4, 6, 8, 10, 16, 24, 34, 47, 61, 78, 97, 100],
                "> 10:1": [0, 4, 5, 8, 12, 15, 23, 33, 44, 57, 72, 89, 100]
            },
            50: {
                "< 3:1": [0, 4, 4, 5, 6, 7, 12, 18, 26, 36, 48, 61, 76, 93, 100],
                "3:1 à 10:1": [0, 4, 4, 5, 7, 9, 14, 20, 29, 38, 50, 63, 79, 95, 100],
                "> 10:1": [0, 4, 5, 8, 11, 14, 21, 29, 38, 48, 61, 74, 90, 100]
            },
            60: {
                "< 3:1": [0, 4, 4, 4, 5, 7, 11, 16, 23, 31, 40, 52, 64, 78, 94, 100],
                "3:1 à 10:1": [0, 4, 4, 5, 6, 8, 12, 18, 25, 33, 43, 54, 66, 81, 96, 100],
                "> 10:1": [0, 4, 5, 7, 10, 13, 19, 26, 34, 43, 53, 64, 77, 92, 100]
            },
            80: {
                "< 3:1": [0, 4, 4, 4, 5, 6, 9, 13, 18, 24, 31, 40, 49, 60, 71, 84, 98, 100],
                "3:1 à 10:1": [0, 4, 4, 5, 6, 7, 10, 15, 20, 26, 33, 42, 51, 62, 74, 86, 100],
                "> 10:1": [0, 4, 5, 6, 9, 11, 16, 22, 28, 35, 43, 52, 62, 73, 85, 98, 100]
            },
            100: {
                "< 3:1": [0, 4, 4, 4, 5, 5, 8, 11, 15, 20, 26, 32, 40, 48, 58, 68, 79, 100],
                "3:1 à 10:1": [0, 4, 4, 4, 5, 6, 9, 13, 17, 22, 28, 35, 42, 51, 60, 70, 81, 100],
                "> 10:1": [0, 4, 4, 6, 8, 10, 14, 19, 25, 31, 37, 44, 52, 61, 71, 81, 92, 100]
            },
            150: {
                "< 3:1": [0, 4, 4, 4, 4, 5, 6, 8, 11, 14, 18, 23, 28, 33, 40, 46, 54, 70, 89, 100],
                "3:1 à 10:1": [0, 4, 4, 4, 5, 6, 8, 10, 13, 16, 20, 25, 30, 36, 42, 49, 56, 73, 92, 100],
                "> 10:1": [0, 4, 4, 5, 7, 8, 12, 16, 20, 24, 29, 34, 39, 46, 52, 59, 67, 84, 100]
            },
            250: {
                "< 3:1": [0, 4, 4, 4, 4, 4, 5, 7, 8, 10, 12, 15, 18, 22, 25, 29, 34, 44, 55, 68, 100],
                "3:1 à 10:1": [0, 4, 4, 4, 4, 5, 6, 8, 10, 12, 14, 17, 20, 24, 27, 32, 36, 46, 57, 70, 100],
                "> 10:1": [0, 4, 4, 5, 6, 7, 9, 12, 15, 18, 21, 25, 28, 32, 37, 41, 46, 56, 68, 81, 100]
            },
            350: {
                "< 3:1": [0, 4, 4, 4, 4, 4, 5, 6, 7, 8, 10, 12, 14, 16, 19, 22, 25, 32, 40, 49, 77, 100],
                "3:1 à 10:1": [0, 4, 4, 4, 4, 4, 5, 7, 8, 10, 12, 14, 16, 18, 21, 24, 27, 34, 43, 52, 79, 100],
                "> 10:1": [0, 4, 4, 4, 5, 6, 8, 10, 13, 15, 18, 21, 23, 26, 30, 33, 36, 44, 53, 62, 90, 100]
            },
            500: {
                "< 3:1": [0, 4, 4, 4, 4, 4, 4, 5, 6, 7, 8, 9, 11, 13, 14, 16, 19, 24, 29, 36, 55, 78, 100],
                "3:1 à 10:1": [0, 4, 4, 4, 4, 4, 5, 6, 7, 8, 9, 11, 13, 14, 16, 18, 21, 26, 31, 38, 57, 80, 100],
                "> 10:1": [0, 4, 4, 4, 5, 5, 7, 9, 11, 13, 15, 17, 19, 21, 24, 26, 29, 35, 41, 48, 68, 92, 100]
            },
            1000: {
                "< 3:1": [0, 4, 4, 4, 4, 4, 4, 4, 5, 5, 6, 6, 7, 8, 9, 10, 11, 14, 16, 20, 29, 41, 55, 71, 89, 100],
                "3:1 à 10:1": [0, 4, 4, 4, 4, 4, 4, 5, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 18, 22, 31, 43, 57, 73, 91, 100],
                "> 10:1": [0, 4, 4, 4, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 16, 18, 20, 23, 26, 30, 41, 53, 68, 84, 100]
            },
            2000: {
                "< 3:1": [0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 6, 6, 7, 7, 9, 10, 12, 16, 22, 29, 37, 46, 56, 68, 80, 94, 100],
                "3:1 à 10:1": [0, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 6, 6, 7, 7, 8, 9, 10, 12, 13, 18, 24, 31, 39, 49, 59, 70, 83, 96, 100],
                "> 10:1": [0, 4, 4, 4, 4, 4, 5, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 18, 20, 26, 33, 41, 50, 59, 70, 81, 94, 100]
            }<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculateur de baies non protégées (CNB)</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f9f9f9; }
        #app { max-width: 800px; margin: 0 auto; padding: 20px; background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        h1 { color: #333; text-align: center; }
        .tab-nav { overflow: hidden; background-color: #f1f1f1; border-bottom: 1px solid #ccc; }
        .tab-nav button { background-color: inherit; float: left; border: none; outline: none; cursor: pointer; padding: 14px 16px; transition: 0.3s; font-size: 16px; }
        .tab-nav button:hover { background-color: #ddd; }
        .tab-nav button.active { background-color: #004d99; color: white; }
        .tab-content { display: none; padding: 20px; border: 1px solid #ccc; border-top: none; }
        .tab-content.active { display: block; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin: 10px 0; font-size: 16px; }
        input[type="number"], select { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { margin: 10px 0; padding: 10px 20px; background-color: #007BFF; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #0056b3; }
        .results { background-color: #f1f1f1; padding: 20px; border-radius: 8px; margin-top: 20px; }
        .info { font-style: italic; font-size: 14px; color: #666; margin-top: 5px; }
        .subsection { padding-left: 20px; margin-top: 20px; border-left: 3px solid #ccc; }
        .toggle-section { cursor: pointer; color: #0056b3; }
        .toggle-section:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div id="app">
        <h1>Calculateur de baies non protégées (CNB)</h1>
        <div class="tab-nav">
            <button class="tab-link active" onclick="openTab(event, 'cnb')">Méthode CNB (3.2.3.)</button>
            <button class="tab-link" onclick="openTab(event, 'method91014')">Méthode 9.10.14</button>
            <button class="tab-link" onclick="openTab(event, 'method91015')">Méthode 9.10.15</button>
        </div>

        <!-- Onglet Méthode CNB (3.2.3.) -->
        <div id="cnb" class="tab-content active">
            <p>Calcul basé sur la section 3.2.3 du CNB</p>
            <div class="form-group">
                <label for="usage_cnb">Usage du bâtiment</label>
                <select id="usage_cnb">
                    <option value="groupes_A_B3_C_D_F3">Usages des groupes A, B division 3, C, D et F division 3</option>
                    <option value="groupes_E_F1_F2">Usages des groupes E et F divisions 1 et 2</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="construction_type_cnb">Type de construction</label>
                <select id="construction_type_cnb">
                    <option value="incombustible">Incombustible</option>
                    <option value="combustible">Combustible</option>
                </select>
                <div class="info">Selon 3.2.3.7, le type de construction a un impact sur les exigences.</div>
            </div>
            
            <div class="form-group">
                <label for="revetement_type_cnb">Type de revêtement</label>
                <select id="revetement_type_cnb">
                    <option value="incombustible">Incombustible</option>
                    <option value="combustible">Combustible</option>
                </select>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="sprinklers_cnb"> Bâtiment entièrement protégé par gicleurs</label>
            </div>
            
            <div class="form-group">
                <label for="distance_cnb">Distance limitative (m)</label>
                <input type="number" id="distance_cnb" value="5" min="0" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="surface_cnb">Surface de la façade de rayonnement (m²)</label>
                <input type="number" id="surface_cnb" value="120" min="0">
            </div>
            
            <div class="form-group">
                <label for="length_cnb">Longueur de la façade (m)</label>
                <input type="number" id="length_cnb" value="20" min="0">
            </div>
            
            <div class="form-group">
                <label for="height_cnb">Hauteur de la façade (m)</label>
                <input type="number" id="height_cnb" value="6" min="0">
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="glass_brick_cnb"> Baies protégées par briques de verre/verre armé</label>
                <div class="info">Selon 3.2.3.12, permet de doubler la surface maximale autorisée.</div>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="response_cnb"> Plus de 10 min dans 10 % ou plus des cas</label>
                <div class="info">Si coché, la distance limitative est divisée par 2 (selon le paragraphe 3.2.3.1. 8))</div>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="fire_dampers_cnb"> Registres coupe-feu pour ouvertures techniques</label>
                <div class="info">Protection des ouvertures techniques dans la façade de rayonnement par registres coupe-feu</div>
            </div>
            
            <div class="toggle-section" onclick="toggleSection('adjacent_facades_cnb_section')">+ Expositions aux façades adjacentes (3.2.3.14)</div>
            <div id="adjacent_facades_cnb_section" class="subsection" style="display: none;">
                <div class="form-group">
                    <label><input type="checkbox" id="has_adjacent_facade_cnb"> Présence de façade adjacente</label>
                </div>
                <div class="form-group">
                    <label for="angle_facades_cnb">Angle entre les façades (degrés)</label>
                    <input type="number" id="angle_facades_cnb" value="90" min="0" max="180" step="1">
                    <div class="info">Angle formé par les façades. Selon 3.2.3.14, l'angle influence le calcul.</div>
                </div>
                <div class="form-group">
                    <label for="adjacent_facade_length_cnb">Longueur de la façade adjacente (m)</label>
                    <input type="number" id="adjacent_facade_length_cnb" value="10" min="0" step="0.1">
                </div>
            </div>
            
            <div class="toggle-section" onclick="toggleSection('adjacent_roof_cnb_section')">+ Expositions à des toits adjacents (3.2.3.15)</div>
            <div id="adjacent_roof_cnb_section" class="subsection" style="display: none;">
                <div class="form-group">
                    <label><input type="checkbox" id="has_adjacent_roof_cnb"> Présence d'un toit adjacent</label>
                </div>
                <div class="form-group">
                    <label for="distance_to_roof_cnb">Distance horizontale entre la façade et le toit (m)</label>
                    <input type="number" id="distance_to_roof_cnb" value="2" min="0" step="0.1">
                    <div class="info">Distance horizontale entre la façade de rayonnement et le toit adjacent.</div>
                </div>
                <div class="form-group">
                    <label for="height_diff_roof_cnb">Différence de hauteur entre ouvertures et toit (m)</label>
                    <input type="number" id="height_diff_roof_cnb" value="3" min="0" step="0.1">
                    <div class="info">Différence de hauteur entre les ouvertures de la façade et le toit adjacent.</div>
                </div>
            </div>
            
            <button onclick="calculateCNB()">Calculer</button>
            <div id="cnb-result" class="results"></div>
        </div>

        <!-- Onglet Méthode 9.10.14 -->
        <div id="method91014" class="tab-content">
            <p>Calcul basé sur la sous-section 9.10.14 du CNB (Tableau 9.10.14.4-A)</p>
            <div class="form-group">
                <label for="usage_91014">Usage du bâtiment</label>
                <select id="usage_91014">
                    <option value="habitation">Habitation, établissement d'affaires et établissement industriel à risques faibles</option>
                    <option value="commercial">Établissement commercial et établissement industriel à risques moyens</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="building_type_91014">Type de bâtiment</label>
                <select id="building_type_91014">
                    <option value="standard">Bâtiment standard</option>
                    <option value="garage">Garage ou bâtiment secondaire</option>
                </select>
                <div class="info">Les garages et bâtiments secondaires peuvent bénéficier d'exemptions selon 9.10.14.4(10-12) et 9.10.14.5(4-5).</div>
            </div>
            
            <div class="form-group">
                <label for="distance_91014">Distance limitative (m)</label>
                <input type="number" id="distance_91014" value="2.0" min="0" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="surface_91014">Surface de la façade de rayonnement (m²)</label>
                <input type="number" id="surface_91014" value="30" min="0">
            </div>
            
            <div class="form-group">
                <label for="exterior_finish_91014">Type de revêtement extérieur</label>
                <select id="exterior_finish_91014">
                    <option value="combustible">Combustible</option>
                    <option value="incombustible">Incombustible</option>
                </select>
                <div class="info">Le type de revêtement est important pour les distances limitatives inférieures à 1,2 m.</div>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="soffit_protection_91014"> Soffites protégés</label>
                <div class="info">Concerne les soffites faisant saillie à moins de 1,2 m de la limite de propriété (9.10.14.5).</div>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="response_91014"> Plus de 10 min dans 10 % ou plus des cas</label>
                <div class="info">Si coché, la distance limitative est divisée par 2 (selon le paragraphe 9.10.14.3. 1))</div>
            </div>
            
            <div class="toggle-section" onclick="toggleSection('adjacent_facades_91014_section')">+ Expositions aux façades adjacentes (9.10.14.14)</div>
            <div id="adjacent_facades_91014_section" class="subsection" style="display: none;">
                <div class="form-group">
                    <label><input type="checkbox" id="has_adjacent_facade_91014"> Présence de façade adjacente</label>
                </div>
                <div class="form-group">
                    <label for="angle_facades_91014">Angle entre les façades (degrés)</label>
                    <input type="number" id="angle_facades_91014" value="90" min="0" max="180" step="1">
                    <div class="info">Angle formé par les façades. Selon 9.10.14.14, influence le calcul.</div>
                </div>
                <div class="form-group">
                    <label for="adjacent_facade_length_91014">Longueur de la façade adjacente (m)</label>
                    <input type="number" id="adjacent_facade_length_91014" value="10" min="0" step="0.1">
                </div>
            </div>
            
            <button onclick="calculate91014()">Calculer</button>
            <div id="method91014-result" class="results"></div>
        </div>

        <!-- Onglet Méthode 9.10.15 -->
        <div id="method91015" class="tab-content">
            <p>Calcul basé sur la sous-section 9.10.15 du CNB (Tableau 9.10.15.4) - Pour habitations</p>
            <div class="info">Cette méthode s'applique uniquement aux bâtiments qui ne renferment que des logements et dont aucun des logements n'est situé au-dessus d'un autre logement.</div>
            
            <div class="form-group">
                <label for="housing_type_91015">Type d'habitation</label>
                <select id="housing_type_91015">
                    <option value="standard">Habitation standard</option>
                    <option value="accessoire">Maison comportant un logement accessoire</option>
                </select>
                <div class="info">Selon 9.10.15.1., les maisons comportant un logement accessoire suivent des règles spécifiques.</div>
            </div>
            
            <div class="form-group">
                <label for="distance_91015">Distance limitative (m)</label>
                <input type="number" id="distance_91015" value="2.0" min="0" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="surface_91015">Surface de la façade de rayonnement (m²)</label>
                <input type="number" id="surface_91015" value="50" min="0">
            </div>
            
            <div class="form-group">
                <label for="reveting_type_91015">Type de revêtement extérieur</label>
                <select id="reveting_type_91015">
                    <option value="combustible">Combustible</option>
                    <option value="incombustible">Incombustible</option>
                </select>
                <div class="info">Selon 9.10.15.5, le type de revêtement a un impact sur les exigences de construction.</div>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="response_91015"> Plus de 10 min dans 10 % ou plus des cas</label>
                <div class="info">Si coché, la distance limitative est divisée par 2 (selon le paragraphe 9.10.15.3. 1))</div>
            </div>
            
            <button onclick="calculate91015()">Calculer</button>
            <div id="method91015-result" class="results"></div>
        </div>
    </div>

    <script>
        // Tableau 3.2.3.1.-B - Usages des groupes A, B3, C, D et F3 - Sans gicleurs
        const tableauGroupesAB3CDF3 = {
            10: {
                "< 3:1": [0, 8, 10, 18, 29, 46, 91, 100],
                "3:1 à 10:1": [0, 8, 12, 21, 33, 50, 96, 100],
                "> 10:1": [0, 11, 18, 32, 48, 68, 100]
            },
            15: {
                "< 3:1": [0, 7, 9, 14, 22, 33, 63, 100],
                "3:1 à 10:1": [0, 8, 10, 17, 25, 37, 67, 100],
                "> 10:1": [0, 10, 15, 26, 39, 53, 87, 100]
            },
            20: {
                "< 3:1": [0, 7, 9, 12, 18, 26, 49, 81, 100],
                "3:1 à 10:1": [0, 8, 10, 15, 21, 30, 53, 85, 100],
                "> 10:1": [0, 9, 14, 23, 33, 45, 72, 100]
            },
            25: {
                "< 3:1": [0, 7, 8, 11, 16, 23, 41, 66, 98, 100],
                "3:1 à 10:1": [0, 8, 9, 13, 19, 26, 45, 70, 100],
                "> 10:1": [0, 9, 13, 21, 30, 39, 62, 90, 100]
            },
            30: {
                "< 3:1": [0, 7, 8, 11, 15, 20, 35, 56, 83, 100],
                "3:1 à 10:1": [0, 7, 9, 12, 17, 23, 39, 61, 88, 100],
                "> 10:1": [0, 8, 12, 19, 27, 36, 56, 79, 100]
            },
            40: {
                "< 3:1": [0, 7, 8, 10, 13, 17, 28, 44, 64, 89, 100],
                "3:1 à 10:1": [0, 7, 8, 11, 15, 20, 32, 48, 69, 93, 100],
                "> 10:1": [0, 8, 11, 17, 24, 31, 47, 66, 88, 100]
            },
            50: {
                "< 3:1": [0, 7, 8, 9, 12, 15, 24, 37, 53, 72, 96, 100],
                "3:1 à 10:1": [0, 7, 8, 10, 14, 18, 28, 41, 57, 77, 100],
                "> 10:1": [0, 8, 10, 15, 21, 28, 41, 57, 76, 97, 100]
            },
            60: {
                "< 3:1": [0, 7, 8, 9, 11, 14, 21, 32, 45, 62, 81, 100],
                "3:1 à 10:1": [0, 7, 8, 10, 13, 16, 25, 36, 49, 66, 85, 100],
                "> 10:1": [0, 8, 10, 14, 20, 25, 38, 51, 67, 85, 100]
            },
            80: {
                "< 3:1": [0, 7, 7, 8, 10, 12, 18, 26, 36, 48, 62, 79, 98, 100],
                "3:1 à 10:1": [0, 7, 8, 9, 11, 14, 21, 29, 40, 52, 67, 84, 100],
                "> 10:1": [0, 8, 9, 13, 17, 22, 32, 44, 56, 70, 86, 100]
            },
            100: {
                "< 3:1": [0, 7, 7, 8, 9, 11, 16, 22, 30, 40, 51, 65, 80, 97, 100],
                "3:1 à 10:1": [0, 7, 8, 9, 11, 13, 18, 25, 34, 44, 56, 69, 84, 100],
                "> 10:1": [0, 7, 9, 12, 16, 20, 29, 39, 49, 61, 74, 89, 100]
            },
            150: {
                "< 3:1": [0, 7, 7, 8, 9, 10, 13, 17, 22, 29, 37, 46, 56, 67, 79, 93, 100],
                "3:1 à 10:1": [0, 7, 7, 8, 10, 11, 15, 20, 26, 33, 41, 50, 60, 71, 84, 97, 100],
                "> 10:1": [0, 7, 8, 11, 13, 17, 24, 31, 39, 48, 57, 68, 79, 91, 100]
            },
            250: {
                "< 3:1": [0, 7, 7, 7, 8, 9, 10, 13, 16, 20, 25, 30, 36, 43, 51, 59, 68, 87, 100],
                "3:1 à 10:1": [0, 7, 7, 8, 9, 10, 12, 15, 19, 24, 28, 34, 40, 47, 55, 63, 72, 92, 100],
                "> 10:1": [0, 7, 8, 9, 11, 14, 19, 24, 30, 36, 43, 50, 57, 65, 73, 82, 92, 100]
            },
            350: {
                "< 3:1": [0, 7, 7, 7, 8, 8, 9, 11, 14, 16, 20, 24, 28, 33, 38, 44, 50, 64, 81, 99, 100],
                "3:1 à 10:1": [0, 7, 7, 8, 8, 9, 11, 13, 16, 19, 23, 27, 32, 37, 42, 48, 55, 69, 85, 100],
                "> 10:1": [0, 7, 8, 9, 10, 12, 16, 21, 25, 30, 36, 41, 47, 53, 59, 66, 73, 88, 100]
            },
            500: {
                "< 3:1": [0, 7, 7, 7, 7, 8, 9, 10, 12, 14, 16, 19, 22, 25, 29, 33, 37, 47, 59, 71, 100],
                "3:1 à 10:1": [0, 7, 7, 7, 8, 8, 10, 12, 14, 16, 19, 22, 25, 29, 33, 37, 41, 52, 63, 76, 100],
                "> 10:1": [0, 7, 7, 8, 9, 11, 14, 18, 22, 25, 30, 34, 38, 43, 48, 53, 58, 70, 82, 96, 100]
            },
            1000: {
                "< 3:1": [0, 7, 7, 7, 7, 7, 8, 9, 9, 10, 12, 13, 14, 16, 18, 20, 22, 27, 33, 39, 58, 82, 100],
                "3:1 à 10:1": [0, 7, 7, 7, 7, 8, 9, 10, 11, 12, 14, 15, 17, 19, 21, 23, 26, 31, 37, 43, 63, 86, 100],
                "> 10:1": [0, 7, 7, 8, 8, 9, 11, 13, 16, 19, 21, 24, 27, 30, 33, 36, 39, 46, 53, 60, 82, 100]
            },
            2000: {
                "< 3:1": [0, 7, 7, 7, 7, 7, 7, 8, 8, 9, 9, 10, 11, 12, 13, 14, 15, 17, 20, 23, 33, 44, 58, 74, 93, 100],
                "3:1 à 10:1": [0, 7, 7, 7, 7, 7, 8, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 20, 23, 27, 37, 49, 63, 79, 97, 100],
                "> 10:1": [0, 7, 7, 7, 8, 8, 9, 11, 12, 14, 16, 18, 19, 21, 23, 25, 27, 32, 36, 40, 53, 66, 82, 99, 100]
            }
        };
        
        // Tableau 3.2.3.1.-C - Usages des groupes E, F1 et F2 - Sans gicleurs
        const tableauGroupesEF1F2 = {
            10: {
                "< 3:1": [0, 4, 5, 9, 15, 23, 46, 77, 100],
                "3:1 à 10:1": [0, 4, 6, 10, 17, 25, 48, 79, 100],
                "> 10:1": [0, 5, 9, 16, 24, 34, 58, 91, 100]
            },
            15: {
                "< 3:1": [0, 4, 5, 7, 11, 16, 32, 53, 79, 100],
                "3:1 à 10:1": [0, 4, 5, 8, 13, 18, 34, 55, 82, 100],
                "> 10:1": [0, 5, 8, 13, 19, 26, 43, 66, 93, 100]
            },
            20: {
                "< 3:1": [0, 4, 4, 6, 9, 13, 25, 40, 61, 85, 100],
                "3:1 à 10:1": [0, 4, 5, 7, 11, 15, 27, 43, 63, 87, 100],
                "> 10:1": [0, 5, 7, 11, 17, 22, 36, 53, 74, 99, 100]
            },
            25: {
                "< 3:1": [0, 4, 4, 6, 8, 11, 20, 33, 49, 69, 92, 100],
                "3:1 à 10:1": [0, 4, 5, 7, 9, 13, 22, 35, 51, 71, 94, 100],
                "> 10:1": [0, 4, 6, 10, 15, 20, 31, 45, 62, 82, 100]
            },
            30: {
                "< 3:1": [0, 4, 4, 5, 7, 10, 18, 28, 42, 58, 77, 100],
                "3:1 à 10:1": [0, 4, 4, 6, 9, 12, 20, 30, 44, 60, 80, 100],
                "> 10:1": [0, 4, 6, 10, 14, 18, 28, 40, 54, 71, 91, 100]
            },
            40: {
                "< 3:1": [0, 4, 4, 5, 6, 8, 14, 22, 32, 44, 59, 76, 94, 100],
                "3:1 à 10:1": [0, 4, 4, 6, 8, 10, 16, 24, 34, 47, 61, 78, 97, 100],
                ">
