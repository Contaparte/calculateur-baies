<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculateur de baies non protégées (CNB)</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      line-height: 1.6;
      margin: 0;
      padding: 0;
      background-color: #f8f9fa;
    }
    .container {
      max-width: 1000px;
      margin: 20px auto;
      padding: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    h1 {
      font-size: 24px;
      margin-bottom: 20px;
      color: #333;
      text-align: center;
    }
    /* Style pour les onglets */
    .tab {
      overflow: hidden;
      border-bottom: 1px solid #ccc;
      margin-bottom: 20px;
    }
    .tab button {
      background-color: inherit;
      float: left;
      border: none;
      outline: none;
      cursor: pointer;
      padding: 14px 16px;
      transition: 0.3s;
      font-size: 16px;
    }
    .tab button:hover {
      background-color: #ddd;
    }
    .tab button.active {
      background-color: #2271b1;
      color: white;
    }
    .tabcontent {
      display: none;
    }
    /* Réutilisation du style existant */
    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
    }
    @media (min-width: 768px) {
      .grid {
        grid-template-columns: 1fr 1fr;
      }
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #444;
    }
    input[type="number"],
    select {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
    }
    button.calculer-btn {
      background-color: #2271b1;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      width: 100%;
      margin-top: 20px;
    }
    button.calculer-btn:hover {
      background-color: #135e96;
    }
    .results {
      background-color: #f0f0f1;
      padding: 20px;
      border-radius: 8px;
      min-height: 250px;
    }
    .message {
      text-align: center;
      color: #666;
      padding: 20px 0;
    }
    .details {
      background-color: #e4e4e7;
      padding: 15px;
      border-radius: 4px;
      font-family: monospace;
      white-space: pre-wrap;
      font-size: 14px;
      margin-top: 15px;
    }
    .highlight {
      color: #2271b1;
      font-weight: bold;
    }
    .footer {
      margin-top: 20px;
      font-size: 13px;
      color: #666;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Calculateur de baies non protégées (CNB)</h1>
    
    <!-- Menu onglets -->
    <div class="tab">
      <button class="tablinks active" onclick="openTab(event, 'CNB')">Méthode CNB</button>
      <button class="tablinks" onclick="openTab(event, '914')">Méthode 9.10.14</button>
      <button class="tablinks" onclick="openTab(event, '915')">Méthode 9.10.15</button>
    </div>

    <!-- Onglet CNB (méthode existante) -->
    <div id="CNB" class="tabcontent" style="display: block;">
      <div class="grid">
        <div>
          <div class="form-group">
            <label for="usage-batiment">Usage du bâtiment</label>
            <select id="usage-batiment">
              <option value="habitation">Habitation (Groupe C)</option>
              <option value="affaires">Affaires/Division 3 (Groupe A, B, D, F3)</option>
              <option value="commercial">Commercial (Groupe E)</option>
              <option value="industriel">Industriel div. 1 et 2 (Groupe F1, F2)</option>
            </select>
          </div>
          <div class="form-group">
            <label>Protection par gicleurs</label>
            <div>
              <input type="checkbox" id="gicleurs">
              <span>Bâtiment entièrement protégé par gicleurs</span>
            </div>
          </div>
          <div class="form-group">
            <label for="distance">Distance limitative (m)</label>
            <input type="number" id="distance" min="0" step="0.1" value="1.2">
          </div>
          <div class="form-group">
            <label for="surface">Surface de la façade de rayonnement (m²)</label>
            <input type="number" id="surface" min="1" value="30">
          </div>
          <div class="form-group" id="rapport-container">
            <label for="rapport">Rapport L/H ou H/L</label>
            <select id="rapport">
              <option value="moins3">Moins de 3:1</option>
              <option value="3a10">3:1 à 10:1</option>
              <option value="plus10">Plus de 10:1</option>
            </select>
          </div>
          <div class="form-group">
            <label>Délai d'intervention du service d'incendie</label>
            <div>
              <input type="checkbox" id="intervention">
              <span>Plus de 10 min dans 10% ou plus des cas</span>
            </div>
          </div>
          <button id="calculerCNB" class="calculer-btn">Calculer</button>
        </div>
        <div class="results" id="resultatsCNB">
          <div class="message">
            Les résultats s'afficheront ici après le calcul
          </div>
        </div>
      </div>
    </div>

    <!-- Onglet Méthode 9.10.14 -->
    <div id="914" class="tabcontent">
      <div class="grid">
        <div>
          <div class="form-group">
            <label for="usage-batiment-914">Usage du bâtiment</label>
            <select id="usage-batiment-914">
              <option value="habitation">Habitation (Groupe C)</option>
              <option value="affaires">Affaires/Division 3 (Groupe A, B, D, F3)</option>
              <option value="commercial">Commercial (Groupe E)</option>
              <option value="industriel">Industriel div. 1 et 2 (Groupe F1, F2)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="surface-914">Surface de la façade (m²)</label>
            <input type="number" id="surface-914" min="1" value="30">
          </div>
          <div class="form-group">
            <label for="param-914">Paramètre spécifique (ex: distance ou autre)</label>
            <input type="number" id="param-914" min="0" step="0.1" value="1.2">
          </div>
          <button id="calculer914" class="calculer-btn">Calculer (9.10.14)</button>
        </div>
        <div class="results" id="resultats914">
          <div class="message">
            Les résultats s'afficheront ici après le calcul
          </div>
        </div>
      </div>
    </div>

    <!-- Onglet Méthode 9.10.15 -->
    <div id="915" class="tabcontent">
      <div class="grid">
        <div>
          <div class="form-group">
            <label for="usage-batiment-915">Usage du bâtiment</label>
            <select id="usage-batiment-915">
              <option value="habitation">Habitation (Groupe C)</option>
              <option value="affaires">Affaires/Division 3 (Groupe A, B, D, F3)</option>
              <option value="commercial">Commercial (Groupe E)</option>
              <option value="industriel">Industriel div. 1 et 2 (Groupe F1, F2)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="surface-915">Surface de la façade (m²)</label>
            <input type="number" id="surface-915" min="1" value="30">
          </div>
          <div class="form-group">
            <label for="param-915">Paramètre spécifique (ex: distance ou autre)</label>
            <input type="number" id="param-915" min="0" step="0.1" value="1.2">
          </div>
          <button id="calculer915" class="calculer-btn">Calculer (9.10.15)</button>
        </div>
        <div class="results" id="resultats915">
          <div class="message">
            Les résultats s'afficheront ici après le calcul
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <p>Note: Cet outil utilise les tableaux du Code national du bâtiment du Canada pour déterminer la surface maximale des baies non protégées dans une façade de rayonnement.</p>
      <p>Les valeurs calculées sont basées sur les tableaux du CNB 2015 (intégrant les modifications du Québec) pour la méthode CNB. Les méthodes 9.10.14 et 9.10.15 doivent être ajustées selon les exemples de calcul fournis.</p>
    </div>
  </div>

  <script>
    // Fonction d'affichage des onglets
    function openTab(evt, tabName) {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(tabName).style.display = "block";
      evt.currentTarget.className += " active";
    }

    // --- Calcul méthode CNB (code existant) ---
    const usageBatiment = document.getElementById('usage-batiment');
    const gicleurs = document.getElementById('gicleurs');
    const distance = document.getElementById('distance');
    const surface = document.getElementById('surface');
    const rapport = document.getElementById('rapport');
    const rapportContainer = document.getElementById('rapport-container');
    const intervention = document.getElementById('intervention');
    const calculerCNB = document.getElementById('calculerCNB');
    const resultatsCNB = document.getElementById('resultatsCNB');

    // (Les tableaux et fonctions utilitaires pour le calcul CNB, par exemple getSurfaceProche et getDistanceProche, doivent être inclus ici)
    // Exemple de fonctions utilitaires (à adapter avec vos tableaux réels) :
    function getSurfaceProche(val, tableau) {
      // Logique de sélection de la surface de référence à partir du tableau
      return val; // Valeur indicative à remplacer
    }
    function getDistanceProche(val, tableauDistance) {
      // Logique de sélection de la distance de référence à partir du tableau
      return val; // Valeur indicative à remplacer
    }

    calculerCNB.addEventListener('click', function() {
      let distanceCalcul = parseFloat(distance.value);
      let surfaceVal = parseFloat(surface.value);
      let details = "";

      if (intervention.checked && !gicleurs.checked) {
        distanceCalcul = distanceCalcul / 2;
        details += `Distance limitative ajustée à ${distanceCalcul.toFixed(2)} m (facteur 0.5) en raison du délai d'intervention du service d'incendie.\n\n`;
      }

      let tableauUtilise, surfaceProche, tableauDistances, pourcentage;

      if (gicleurs.checked) {
        // Exemple : tableau pour bâtiments protégés par gicleurs
        tableauUtilise = {}; // À remplacer par vos données
        details += "Tableau utilisé: 3.2.3.1.-D (Bâtiments protégés par gicleurs)\n";
        surfaceProche = getSurfaceProche(surfaceVal, tableauUtilise);
        tableauDistances = tableauUtilise[surfaceProche];
        details += `Surface de référence: ${surfaceProche} m² (surface réelle: ${surfaceVal} m²)\n`;
        const distanceProche = getDistanceProche(distanceCalcul, tableauDistances);
        pourcentage = tableauDistances[distanceProche] || 0;
        details += `Distance limitative de référence: ${distanceProche} m (distance réelle: ${distanceCalcul} m)\n`;
      } else {
        // Exemple : tableau pour bâtiments non protégés par gicleurs
        tableauUtilise = {}; // À remplacer par vos données
        details += "Tableau utilisé: 3.2.3.1.-B (Bâtiments non protégés par gicleurs)\n";
        const sousTableau = tableauUtilise[rapport.value] || {};
        details += `Rapport L/H ou H/L utilisé: ${rapport.value === 'moins3' ? '< 3:1' : rapport.value === '3a10' ? '3:1 à 10:1' : '> 10:1'}\n`;
        surfaceProche = getSurfaceProche(surfaceVal, sousTableau);
        tableauDistances = sousTableau[surfaceProche] || {};
        details += `Surface de référence: ${surfaceProche} m² (surface réelle: ${surfaceVal} m²)\n`;
        const distanceProche = getDistanceProche(distanceCalcul, tableauDistances);
        pourcentage = tableauDistances[distanceProche] || 0;
        details += `Distance limitative de référence: ${distanceProche} m (distance réelle: ${distanceCalcul} m)\n`;
      }

      const surfaceMaxBaies = (surfaceVal * pourcentage) / 100;
      resultatsCNB.innerHTML = `
        <h2>Résultats</h2>
        <p style="font-weight: bold; font-size: 18px;">
          Surface maximale des baies non protégées autorisée: 
          <span class="highlight">${pourcentage}%</span>
        </p>
        <p style="font-weight: bold; font-size: 18px;">
          Soit une surface de: 
          <span class="highlight">${surfaceMaxBaies.toFixed(2)} m²</span>
        </p>
        <h3 style="margin-top: 20px;">Détails du calcul:</h3>
        <div class="details">${details}</div>
      `;
    });

    // --- Calcul méthode 9.10.14 ---
    const usageBatiment914 = document.getElementById('usage-batiment-914');
    const surface914 = document.getElementById('surface-914');
    const param914 = document.getElementById('param-914');
    const calculer914 = document.getElementById('calculer914');
    const resultats914 = document.getElementById('resultats914');

    calculer914.addEventListener('click', function() {
      const usage = usageBatiment914.value;
      const surfaceVal = parseFloat(surface914.value);
      const paramVal = parseFloat(param914.value);
      let details = "Méthode 9.10.14:\n";
      
      // Exemple de logique de calcul (à remplacer par la formule réelle issue de l'exemple fourni)
      let coefficient = (paramVal < 2 ? 8 : 10); 
      let pourcentage = coefficient; 
      let surfaceMax = (surfaceVal * pourcentage) / 100;
      
      details += `Usage: ${usage}\nSurface: ${surfaceVal} m²\nParamètre: ${paramVal}\nCoefficient utilisé: ${coefficient}\n`;
      
      resultats914.innerHTML = `
        <h2>Résultats (Méthode 9.10.14)</h2>
        <p style="font-weight: bold; font-size: 18px;">
          Pourcentage maximal autorisé: 
          <span class="highlight">${pourcentage}%</span>
        </p>
        <p style="font-weight: bold; font-size: 18px;">
          Soit une surface maximale de: 
          <span class="highlight">${surfaceMax.toFixed(2)} m²</span>
        </p>
        <h3 style="margin-top: 20px;">Détails du calcul:</h3>
        <div class="details">${details}</div>
      `;
    });

    // --- Calcul méthode 9.10.15 ---
    const usageBatiment915 = document.getElementById('usage-batiment-915');
    const surface915 = document.getElementById('surface-915');
    const param915 = document.getElementById('param-915');
    const calculer915 = document.getElementById('calculer915');
    const resultats915 = document.getElementById('resultats915');

    calculer915.addEventListener('click', function() {
      const usage = usageBatiment915.value;
      const surfaceVal = parseFloat(surface915.value);
      const paramVal = parseFloat(param915.value);
      let details = "Méthode 9.10.15:\n";
      
      // Exemple de logique de calcul (à adapter selon le deuxième exemple fourni)
      let coefficient = (paramVal < 2 ? 7 : 9);
      let pourcentage = coefficient; 
      let surfaceMax = (surfaceVal * pourcentage) / 100;
      
      details += `Usage: ${usage}\nSurface: ${surfaceVal} m²\nParamètre: ${paramVal}\nCoefficient utilisé: ${coefficient}\n`;
      
      resultats915.innerHTML = `
        <h2>Résultats (Méthode 9.10.15)</h2>
        <p style="font-weight: bold; font-size: 18px;">
          Pourcentage maximal autorisé: 
          <span class="highlight">${pourcentage}%</span>
        </p>
        <p style="font-weight: bold; font-size: 18px;">
          Soit une surface maximale de: 
          <span class="highlight">${surfaceMax.toFixed(2)} m²</span>
        </p>
        <h3 style="margin-top: 20px;">Détails du calcul:</h3>
        <div class="details">${details}</div>
      `;
    });
  </script>
</body>
</html>
